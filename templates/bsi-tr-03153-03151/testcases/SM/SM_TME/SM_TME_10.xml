<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/css" href="../../schema/TR-03153-1-TS.css"?>
<TestCase id="SM_TME_10" xmlns="http://bsi.bund.de/TR03153" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://bsi.bund.de/TR03153 ../../schema/TR-03153-1-TS_version-1-2-0.xsd">
  <Title>Zeitneustart nach Stromlosigkeit</Title>
  <Version>1.2.0</Version>
  <Purpose>Prüfung, ob die interne Zeit im Sicherheitsmodul nach einer Phase der Stromlosigkeit der Technischen Sicherheitseinrichtung, bei der eine korrekt laufende Zeitführung nicht aufrechterhalten werden konnte, mit einem definierten Wert neu startet, welcher eine "Nicht-Stellung" der Uhrzeit eindeutig erkennbar macht.</Purpose>
  <Profiles>
    <Profile>SM_BASIC</Profile>
    <Profile>II_UPDATETIME</Profile>
  </Profiles>
  <References>
    <Reference>BSI TR-03153-1</Reference>
    <Reference>BSI TR-03151-1</Reference>
  </References>
  <Preconditions>
    <Precondition>Die Technische Sicherheitseinrichtung wurde initialisiert.</Precondition>
    <Precondition>Die Zeit innerhalb des Sicherheitsmoduls wurde aktualisiert.</Precondition>
    <Precondition>Der Nutzer admin wurde von der Technischen Sicherheitseinrichtung authentifiziert.</Precondition>
  </Preconditions>
  <TestSteps>
    <TestStep>
      <Command>Aufruf der Zeitaktualisierungsfunktion.</Command>
      <RefFunction>updateTime</RefFunction>
      <RefUser>admin</RefUser>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Die Stromzufuhr zur TSE wird unterbrochen.</Command>
      <ExpectedResults>
        <ExpectedResult>Die TSE ist eine ausreichende Zeit stromlos.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Die TSE wird wieder mit Strom versorgt.</Command>
      <ExpectedResults>
        <ExpectedResult>Es können weitere Funktionalitäten aufgerufen werden.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität zur Authentifizierung von Nutzern.</Command>
      <RefFunction>authenticateUser</RefFunction>
      <RefUser>admin</RefUser>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität für den Export aller Log-Nachrichten sowie von Zertifikaten und Zusatzdateien.</Command>
      <RefFunction>exportLogMessages</RefFunction>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
        <ExpectedResult>Die TSE-Schnittstelle gibt einen TAR-Container zurück.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Identifikation der Log-Nachricht für die Authentifizierung des Nutzers in dem TAR-Container. Die Identifikation erfolgt anhand des Dateinamens.</Command>
      <ExpectedResults>
        <ExpectedResult>Der TAR-Container enthält eine Log-Nachricht für die Authentifizierung des Nutzers.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Prüfung der Inhalte von Datenfeldern in der Log-Nachricht für die Authentifizierung des Nutzers in dem TAR-Container.</Command>
      <ExpectedResults>
        <ExpectedResult>Der Wert des Datenfelds signatureCreationTime entspricht einem Wert der die "Nicht-Stellung" der Uhrzeit erkennbar macht.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
  </TestSteps>
</TestCase>