<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/css" href="../../schema/TR-03153-1-TS.css"?>
<TestCase id="II_AUT_19" xmlns="http://bsi.bund.de/TR03153" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://bsi.bund.de/TR03153 ../../schema/TR-03153-1-TS_version-1-2-0.xsd">
  <Title>Fehlerweiterleitung von Abmelden zu Authentifizierung</Title>
  <Version>1.2.0</Version>
  <Purpose>Prüfung, ob Fehlermeldungen der Funktionalität zum Abmelden von Nutzern an die aufrufende Funktionalität zur Authentifizierung von Nutzern weitergereicht werden, wenn erstere durch zweitere ausgelöst wird.</Purpose>
  <RefFunction>authenticateUser</RefFunction>
  <RefFunction>logOut</RefFunction>
  <RefUser>logger</RefUser>
  <RefUser>admin</RefUser>
  <Profiles>
    <Profile>II</Profile>
  </Profiles>
  <References>
    <Reference>BSI TR-03153-1</Reference>
    <Reference>BSI TR-03151-1</Reference>
  </References>
  <Preconditions>
    <Precondition>Die Technische Sicherheitseinrichtung wurde initialisiert.</Precondition>
    <Precondition>Die Zeit innerhalb des Sicherheitsmoduls wurde aktualisiert.</Precondition>
    <Precondition>Der Nutzer logger wurde von der Technischen Sicherheitseinrichtung authentifiziert.</Precondition>
    <Precondition>Der Hersteller stellt eine Anleitung und eventuell notwendige Tools bereit, um Fehler in die Ausführung der Funktionalität zum Abmelden von Nutzern zu provozieren, wenn diese durch die Funktionalität zur Authentifizierung des Nutzers admin aufgerufen wurde.</Precondition>
  </Preconditions>
  <TestSteps>
    <TestStep>
      <Command>Aufruf der Funktionalität zur Authentifizierung des Nutzers admin. In der Ausführung der Funktionalität zum Abmelden von Nutzern werden Fehler provoziert.</Command>
      <RefFunction>authenticateUser</RefFunction>
      <RefFunction>logOut</RefFunction>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird beendet und es wird die Fehlermeldung  ausgelöst.</ExpectedResult>
        <ExpectedResult>Die Ausführung wird beendet und es wird eine Fehlermeldung ausgelöst, die zu dem Fehler passt, der in der Funktionalität zum Abmelden von Nutzern provoziert wurde.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
  </TestSteps>
  <AlternativeTestProcedures>
    <AlternativeTestProcedure>Ist eine praktische Durchführung der beschriebenen Testschritte nicht möglich, ist dies plausibel zu begründen. In diesem Fall erfolgt alternativ eine formale Prüfung aufgrund geeigneter Auszüge aus dem Quellcode und - falls zum Verständnis notwendig - weiterer Herstellerdokumentation. Es ist zu belegen, dass Fehlermeldungen der Funktionalität zum Abmelden von Nutzern an die aufrufende Funktionalität zur Authentifizierung von Nutzern weitergereicht werden.</AlternativeTestProcedure>
  </AlternativeTestProcedures>
</TestCase>