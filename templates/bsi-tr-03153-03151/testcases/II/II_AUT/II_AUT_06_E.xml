<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/css" href="../../schema/TR-03153-1-TS.css"?>
<TestCase id="II_AUT_06_E" xmlns="http://bsi.bund.de/TR03153" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://bsi.bund.de/TR03153 ../../schema/TR-03153-1-TS_version-1-2-0.xsd">
  <Title>Unautorisierter Aufruf: Update-Installation</Title>
  <Version>1.2.0</Version>
  <Purpose>Prüfung, ob ein nicht angemeldeter Nutzer Funktionen aufrufen kann, die nur von angemeldeten Nutzern verwendet werden dürfen.
Es werden Parameter in der Form übergeben, dass ein berechtigter Nutzer die Funktion erfolgreich durchführen könnte.
Es wird die Funktionalität zur Installation von Updates für die TSE getestet und ErrorUserNotAuthenticated  erwartet.</Purpose>
  <RefFunction>updateDevice</RefFunction>
  <RefUser>unauthenticated</RefUser>
  <Profiles>
    <Profile>II_UPDATEDEVICE</Profile>
  </Profiles>
  <References>
    <Reference>BSI TR-03153-1</Reference>
    <Reference>BSI TR-03151-1</Reference>
  </References>
  <Preconditions>
    <Precondition>Die Technische Sicherheitseinrichtung wurde initialisiert.</Precondition>
    <Precondition>Die Zeit innerhalb des Sicherheitsmoduls wurde aktualisiert.</Precondition>
    <Precondition>Der aktuelle Nutzer ist der Nutzer unauthenticated.</Precondition>
  </Preconditions>
  <TestSteps>
    <TestStep>
      <Command>Aufruf der Funktionalität zur Installation von Updates für die TSE.</Command>
      <RefFunction>updateDevice</RefFunction>
      <RefUser>unauthenticated</RefUser>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird beendet und es wird die Fehlermeldung ErrorUserNotAuthenticated  ausgelöst.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
  </TestSteps>
</TestCase>