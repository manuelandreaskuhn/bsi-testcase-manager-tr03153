<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/css" href="../../schema/TR-03153-1-TS.css"?>
<TestCase id="II_SDE_01" xmlns="http://bsi.bund.de/TR03153" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://bsi.bund.de/TR03153 ../../schema/TR-03153-1-TS_version-1-2-0.xsd">
  <Title>Beschreibung setzen mit verschiedenen Zeichenlängen</Title>
  <Version>1.2.0</Version>
  <Purpose>Prüfung, ob die Funktionalität zum Erstellen oder Ändern der Beschreibung der TSE verschiedene Längen (bis zu 64 Zeichen) als Eingabeparameter akzeptiert. Zusätzlich wird geprüft, ob die neu gesetzt Beschreibung in der TSE verwendet wird, ob die Ausführung ohne Fehlermeldung beendet wird und, ob die Log-Nachricht korrekt erstellt wird.</Purpose>
  <RefFunction>setDescription</RefFunction>
  <RefUser>admin</RefUser>
  <Profiles>
    <Profile>II</Profile>
  </Profiles>
  <References>
    <Reference>BSI TR-03153-1</Reference>
    <Reference>BSI TR-03151-1</Reference>
  </References>
  <Preconditions>
    <Precondition>Die Technische Sicherheitseinrichtung wurde initialisiert.</Precondition>
    <Precondition>Die Zeit innerhalb des Sicherheitsmoduls wurde aktualisiert.</Precondition>
    <Precondition>Der Nutzer admin wurde von der Technischen Sicherheitseinrichtung authentifiziert.</Precondition>
  </Preconditions>
  <TestSteps>
    <TestStep>
      <Command>Aufruf der Funktionalität zum Erstellen oder Ändern der Beschreibung der TSE. Der für description übergebene Wert wird als $description1 festgehalten. Die Zeichenlänge der Beschreibung ist 1.</Command>
      <RefFunction>setDescription</RefFunction>
      <RefUser>admin</RefUser>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität zum Auslesen der Beschreibung der TSE.</Command>
      <RefFunction>getDescription</RefFunction>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
        <ExpectedResult>Der Rückgabewert description entspricht dem zuvor als $description1 festgehaltenen Wert.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität für den Export aller Log-Nachrichten sowie von Zertifikaten und Zusatzdateien.</Command>
      <RefFunction>exportLogMessages</RefFunction>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
        <ExpectedResult>Die TSE-Schnittstelle gibt einen TAR-Container zurück.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Identifikation der Log-Nachricht für das Erstellen oder Ändern der Beschreibung der TSE in dem TAR-Container. Die Identifikation erfolgt anhand des Dateinamens.</Command>
      <ExpectedResults>
        <ExpectedResult>Der TAR-Container enthält eine Log-Nachricht für das Erstellen oder Ändern der Beschreibung der TSE.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Prüfung der Inhalte von Datenfeldern in der Log-Nachricht für das Erstellen oder Ändern der Beschreibung der TSE in dem TAR-Container.</Command>
      <ExpectedResults>
        <ExpectedResult>Der Wert des Datenfelds eventType entspricht setDescription.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds eventOrigin entspricht integration-interface.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds eventTriggeredByUser entspricht admin.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds newDeviceDescription entspricht dem zuvor als $description1 festgehaltenen Wert.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Identifikation der Datei info.csv in dem TAR-Container anhand des Dateinamens.</Command>
      <ExpectedResults>
        <ExpectedResult>Der TAR-Container enthält eine Datei mit dem Dateinamen info.csv.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Prüfung der Inhalte der in dem TAR-Container enthaltenern Datei info.csv.</Command>
      <ExpectedResults>
        <ExpectedResult>Der Wert des Datenfelds description entspricht der neu gesetzten Beschreibung $description1.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität zum Erstellen oder Ändern der Beschreibung der TSE. Der für description übergebene Wert wird als $description2 festgehalten. Die Zeichenlänge der Beschreibung ist 64.</Command>
      <RefFunction>setDescription</RefFunction>
      <RefUser>admin</RefUser>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität zum Auslesen der Beschreibung der TSE.</Command>
      <RefFunction>getDescription</RefFunction>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
        <ExpectedResult>Der Rückgabewert description entspricht dem zuvor als $description2 festgehaltenen Wert.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität für den Export aller Log-Nachrichten sowie von Zertifikaten und Zusatzdateien.</Command>
      <RefFunction>exportLogMessages</RefFunction>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
        <ExpectedResult>Die TSE-Schnittstelle gibt einen TAR-Container zurück.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Identifikation der Log-Nachricht für das Erstellen oder Ändern der Beschreibung der TSE in dem TAR-Container. Die Identifikation erfolgt anhand des Dateinamens.</Command>
      <ExpectedResults>
        <ExpectedResult>Der TAR-Container enthält eine Log-Nachricht für das Erstellen oder Ändern der Beschreibung der TSE.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Prüfung der Inhalte von Datenfeldern in der Log-Nachricht für das Erstellen oder Ändern der Beschreibung der TSE in dem TAR-Container.</Command>
      <ExpectedResults>
        <ExpectedResult>Der Wert des Datenfelds eventType entspricht setDescription.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds eventOrigin entspricht integration-interface.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds eventTriggeredByUser entspricht admin.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds newDeviceDescription entspricht dem zuvor als $description2 festgehaltenen Wert.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Identifikation der Datei info.csv in dem TAR-Container anhand des Dateinamens.</Command>
      <ExpectedResults>
        <ExpectedResult>Der TAR-Container enthält eine Datei mit dem Dateinamen info.csv.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Prüfung der Inhalte der in dem TAR-Container enthaltenern Datei info.csv.</Command>
      <ExpectedResults>
        <ExpectedResult>Der Wert des Datenfelds description entspricht der neu gesetzten Beschreibung $description2.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität zum Erstellen oder Ändern der Beschreibung der TSE. Der für description übergebene Wert wird als $description3 festgehalten. Die Zeichenlänge der Beschreibung ist zwischen 2 und 63.</Command>
      <RefFunction>setDescription</RefFunction>
      <RefUser>admin</RefUser>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität zum Auslesen der Beschreibung der TSE.</Command>
      <RefFunction>getDescription</RefFunction>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
        <ExpectedResult>Der Rückgabewert description entspricht dem zuvor als $description3 festgehaltenen Wert.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität für den Export aller Log-Nachrichten sowie von Zertifikaten und Zusatzdateien.</Command>
      <RefFunction>exportLogMessages</RefFunction>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
        <ExpectedResult>Die TSE-Schnittstelle gibt einen TAR-Container zurück.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Identifikation der Log-Nachricht für das Erstellen oder Ändern der Beschreibung der TSE in dem TAR-Container. Die Identifikation erfolgt anhand des Dateinamens.</Command>
      <ExpectedResults>
        <ExpectedResult>Der TAR-Container enthält eine Log-Nachricht für das Erstellen oder Ändern der Beschreibung der TSE.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Prüfung der Inhalte von Datenfeldern in der Log-Nachricht für das Erstellen oder Ändern der Beschreibung der TSE in dem TAR-Container.</Command>
      <ExpectedResults>
        <ExpectedResult>Der Wert des Datenfelds eventType entspricht setDescription.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds eventOrigin entspricht integration-interface.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds eventTriggeredByUser entspricht admin.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds newDeviceDescription entspricht dem zuvor als $description3 festgehaltenen Wert.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Identifikation der Datei info.csv in dem TAR-Container anhand des Dateinamens.</Command>
      <ExpectedResults>
        <ExpectedResult>Der TAR-Container enthält eine Datei mit dem Dateinamen info.csv.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Prüfung der Inhalte der in dem TAR-Container enthaltenern Datei info.csv.</Command>
      <ExpectedResults>
        <ExpectedResult>Der Wert des Datenfelds description entspricht der neu gesetzten Beschreibung $description3.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
  </TestSteps>
</TestCase>