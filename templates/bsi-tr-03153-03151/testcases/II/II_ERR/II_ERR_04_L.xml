<?xml version='1.0' encoding='utf-8'?>
<TestCase xmlns="http://bsi.bund.de/TR03153" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="II_ERR_04_L" xsi:schemaLocation="http://bsi.bund.de/TR03153 ../../schema/TR-03153-1-TS_version-1-2-0.xsd">
  <Title>ErrorCertificateExpired: Transaktionsaufzeichnung ermöglichen</Title>
  <Version>1.2.0</Version>
  <Purpose>Prüfung, ob Funktionalitäten beendet werden nachdem die entsprechende Log-Nachricht abgelegt wurde und je die Fehlermeldung ErrorCertificateExpired ausgeben, wenn der folgende Zustand gilt: Das Zertifikat zu dem öffentlichen Schlüssel des Schlüsselpaares für die Prüfwerterzeugung in System-Log-Nachrichten ist abgelaufen.
Es werden Parameter in der Form übergeben, dass die Funktionalitäten ohne Fehlermeldung beendet werden würden, wenn das Zertifikat zu dem öffentlichen Schlüssel des Schlüsselpaares für die Prüfwerterzeugung in System-Log-Nachrichten ist nicht abgelaufen wäre.
Es wird die Funktionalität zur Ermöglichung der Aufzeichnung von Transaktionen nach einer vorherigen Unterbindung selbiger getestet.</Purpose>
  <RefFunction>unlockTransactionLogging</RefFunction>
  <RefUser>admin</RefUser>
  <Profiles>
    <Profile>II_UNLOCKTRANSLOGGING</Profile>
  </Profiles>
  <References>
    <Reference>BSI TR-03153-1</Reference>
    <Reference>BSI TR-03151-1</Reference>
  </References>
  <Preconditions>
    <Precondition>Die Technische Sicherheitseinrichtung wurde initialisiert.</Precondition>
    <Precondition>Die Zeit innerhalb des Sicherheitsmoduls wurde aktualisiert.</Precondition>
    <Precondition>Der Nutzer admin wurde von der Technischen Sicherheitseinrichtung authentifiziert.</Precondition>
    <Precondition>Das Zertifikat zu dem öffentlichen Schlüssel des Schlüsselpaares für die Prüfwerterzeugung in System-Log-Nachrichten ist abgelaufen.</Precondition>
  </Preconditions>
  <TestSteps>
    <TestStep>
      <Command>Aufruf der Funktionalität zur Ermöglichung der Aufzeichnung von Transaktionen nach einer vorherigen Unterbindung selbiger.</Command>
      <RefFunction>unlockTransactionLogging</RefFunction><RefUser>admin</RefUser><ExpectedResults>
        <ExpectedResult>Die Ausführung wird beendet und es wird die Fehlermeldung ErrorCertificateExpired ausgelöst.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität für den Export aller Log-Nachrichten sowie Zertifikate und Zusatzdateien.</Command>
      <RefFunction>unlockTransactionLogging</RefFunction><RefUser>admin</RefUser><ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
        <ExpectedResult>Die TSE-Schnittstelle gibt einen TAR-Container zurück.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Identifikation der Log-Nachricht für die Funktionalität zur Ermöglichung der Aufzeichnung von Transaktionen nach einer vorherigen Unterbindung selbiger. Die Identifikation erfolgt anhand des Dateinamens.</Command>
      <ExpectedResults>
        <ExpectedResult>Der TAR-Container enthält eine Log-Nachricht für die Ermöglichung der Aufzeichnung von Transaktionen nach einer vorherigen Unterbindung selbiger.</ExpectedResult>
        <ExpectedResult>Die Log-Nachricht kann dem Aufruf aus dem ersten Testschritt eindeutig zugeordnet werden.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
  </TestSteps>
</TestCase>