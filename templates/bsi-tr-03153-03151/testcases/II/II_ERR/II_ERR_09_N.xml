<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/css" href="../../schema/TR-03153-1-TS.css"?>
<TestCase id="II_ERR_09_N" xmlns="http://bsi.bund.de/TR03153" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://bsi.bund.de/TR03153 ../../schema/TR-03153-1-TS_version-1-2-0.xsd">
  <Title>ErrorSignatureCounterExhausted: Transaktion aktualisieren</Title>
  <Version>1.2.0</Version>
  <Purpose>Prüfung, ob Funktionalitäten beendet werden und die Fehlermeldung ErrorSignatureCounterExhausted ausgeben, wenn der Verdacht besteht, dass der physische Speicher des Signaturzählers nicht mehr fehlerfrei funktioniert und eine weitere Signatur erstellt werden soll.
Es werden Parameter in der Form übergeben, dass die Funktionalitäten ohne Fehlermeldung beendet werden würden, wenn kein Verdacht bestehen würde, dass der physische Speicher des Signaturzählers nicht mehr fehlerfrei funktioniert.
Es wird die Funktionalität für die Aktualisierung einer Transaktion getestet.</Purpose>
  <Profiles>
    <Profile>II</Profile>
  </Profiles>
  <References>
    <Reference>BSI TR-03153-1</Reference>
    <Reference>BSI TR-03151-1</Reference>
  </References>
  <Preconditions>
    <Precondition>Die Technische Sicherheitseinrichtung wurde initialisiert.</Precondition>
    <Precondition>Die Zeit innerhalb des Sicherheitsmoduls wurde aktualisiert.</Precondition>
    <Precondition>Der Nutzer logger wurde von der Technischen Sicherheitseinrichtung authentifiziert.</Precondition>
    <Precondition>Der physische Speicher des Signaturzählers funktioniert nicht mehr fehlerfrei.</Precondition>
    <Precondition>Eine gestartete und nicht abgeschlossene Transaktion wird von der TSE verwaltet.</Precondition>
  </Preconditions>
  <TestSteps>
    <TestStep>
      <Command>Aufruf der Funktionalität für die Aktualisierung einer Transaktion.  Es wird die in den Preconditions vorgesehene Transaktion aktualisiert.</Command>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird beendet und es wird die Fehlermeldung ErrorSignatureCounterExhausted ausgelöst.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
  </TestSteps>
  <AlternativeTestProcedures>
    <AlternativeTestProcedure>Ist eine praktische Durchführung der beschriebenen Testschritte nicht möglich, ist dies plausibel zu begründen. In diesem Fall erfolgt alternativ eine formale Prüfung aufgrund geeigneter Auszüge aus dem Quellcode und - falls zum Verständnis notwendig - weiterer Herstellerdokumentation. Es ist ein geeigneter Nachweis zu erbringen, dass die Fehlermeldung ErrorSignatureCounterExhausted von der Funktionalität für die Aktualisierung einer Transaktion ausgelöst wird, wenn der Verdacht besteht, dass der physische Speicher des Signaturzählers nicht mehr fehlerfrei funktioniert und eine weitere Signatur erstellt werden soll.</AlternativeTestProcedure>
  </AlternativeTestProcedures>
</TestCase>