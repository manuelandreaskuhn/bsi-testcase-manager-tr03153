<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/css" href="../../schema/TR-03153-1-TS.css"?>
<TestCase id="II_ERR_11_G" xmlns="http://bsi.bund.de/TR03153" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://bsi.bund.de/TR03153 ../../schema/TR-03153-1-TS_version-1-2-0.xsd">
  <Title>ErrorSigningEventDataFailed: Update installieren</Title>
  <Version>1.2.0</Version>
  <Purpose>Prüfung, ob Funktionalitäten beendet werden und die Fehlermeldung ErrorSigningEventDataFailed ausgeben, wenn die Funktionalität des Sicherheitsmoduls fehlschlägt, die die notwendigen Bestandteile der Log-Nachricht bestimmen soll.
Es werden Parameter in der Form übergeben, dass die Funktionalitäten ohne Fehlermeldung beendet werden würden, wenn die Funktionalität des Sicherheitsmoduls nicht fehlschlagen würde, die die notwendigen Bestandteile der Log-Nachricht bestimmen soll.
Es wird die Funktionalität zur Installation von Updates für die TSE getestet.</Purpose>
  <Profiles>
    <Profile>II_UPDATEDEVICE</Profile>
  </Profiles>
  <References>
    <Reference>BSI TR-03153-1</Reference>
    <Reference>BSI TR-03151-1</Reference>
  </References>
  <Preconditions>
    <Precondition>Die Technische Sicherheitseinrichtung wurde initialisiert.</Precondition>
    <Precondition>Die Zeit innerhalb des Sicherheitsmoduls wurde aktualisiert.</Precondition>
    <Precondition>Der Nutzer admin wurde von der Technischen Sicherheitseinrichtung authentifiziert.</Precondition>
  </Preconditions>
  <TestSteps>
    <TestStep>
      <Command>Aufruf der Funktionalität zur Installation von Updates für die TSE. Es wird ein Fehler im Sicherheitsmodul provoziert, sodass das Scherheitsmodul nicht die notwendigen Teile der Log-Nachricht erstellen kann.</Command>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird beendet und es wird die Fehlermeldung ErrorSigningEventDataFailed ausgelöst.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
  </TestSteps>
  <AlternativeTestProcedures>
    <AlternativeTestProcedure>Ist eine praktische Durchführung der beschriebenen Testschritte nicht möglich, ist dies plausibel zu begründen. In diesem Fall erfolgt alternativ eine formale Prüfung aufgrund geeigneter Auszüge aus dem Quellcode und - falls zum Verständnis notwendig - weiterer Herstellerdokumentation. Es ist ein geeigneter Nachweis zu erbringen, dass die Fehlermeldung ErrorSigningEventDataFailed von der Funktionalität zur Installation von Updates für die TSE ausgelöst wird, wenn die Funktionalität des Sicherheitsmoduls fehlschlägt, die die notwendigen Bestandteile der Log-Nachricht bestimmen soll.</AlternativeTestProcedure>
  </AlternativeTestProcedures>
</TestCase>