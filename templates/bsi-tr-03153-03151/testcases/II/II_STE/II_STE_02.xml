<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/css" href="../../schema/TR-03153-1-TS.css"?>
<TestCase id="II_STE_02" xmlns="http://bsi.bund.de/TR03153" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://bsi.bund.de/TR03153 ../../schema/TR-03153-1-TS_version-1-2-0.xsd">
  <Title>Selbsttest: Warnungen allgemein verständlich</Title>
  <Version>1.2.0</Version>
  <Purpose>Prüfung, ob Warnungen, die im Falle eines fehlgeschlagenen Selbsttests ausgegeben werden können, allgemein verständlich verfasst sind.</Purpose>
  <RefFunction>selfTest</RefFunction>
  <RefUser>logger</RefUser>
  <Profiles>
    <Profile>II</Profile>
  </Profiles>
  <References>
    <Reference>BSI TR-03153-1</Reference>
    <Reference>BSI TR-03151-1</Reference>
  </References>
  <Preconditions>
    <Precondition>Die Technische Sicherheitseinrichtung wurde initialisiert.</Precondition>
    <Precondition>Die Zeit innerhalb des Sicherheitsmoduls wurde aktualisiert.</Precondition>
    <Precondition>Der Nutzer logger wurde von der Technischen Sicherheitseinrichtung authentifiziert.</Precondition>
    <Precondition>Der Hersteller stellt eine Liste aller Fehler- und Warnmeldungen, die im Falle eines fehlgeschlagenen Selbsttest im Element errorMessage abgelegt werden können, zur Verfügung.</Precondition>
  </Preconditions>
  <TestSteps>
    <TestStep>
      <Command>Aufruf der Funktionalität zur Auslösung eines Selbsttests. Es wird ein Fehler provoziert, der dazu führt, dass ein Selbsttest fehlschlägt.</Command>
      <RefFunction>selfTest</RefFunction>
      <RefUser>logger</RefUser>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
        <ExpectedResult>Es wird ein Wert (selfTestResults des Typs SelfTestResultSet) zurückgegeben.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität für den Export aller Log-Nachrichten sowie von Zertifikaten und Zusatzdateien.</Command>
      <RefFunction>exportLogMessages</RefFunction>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
        <ExpectedResult>Die TSE-Schnittstelle gibt einen TAR-Container zurück.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Identifikation der Log-Nachricht für die Auslösung des Selbsttests in dem TAR-Container. Die Identifikation erfolgt anhand des Dateinamens.</Command>
      <ExpectedResults>
        <ExpectedResult>Der TAR-Container enthält eine Log-Nachricht für die Auslösung des Selbsttests.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Prüfung der Inhalte von Datenfeldern in der Log-Nachricht für die Auslösung des Selbsttests in dem TAR-Container.</Command>
      <ExpectedResults>
        <ExpectedResult>Der Wert des Datenfelds eventType entspricht selfTest.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds eventOrigin entspricht integration-interface.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds eventTriggeredByUser entspricht logger.</ExpectedResult>
        <ExpectedResult>Die Log-Nachricht enthält das Element SelfTestEventData mit einer Seqenz aus selfTestResults und allTestsArePositive. Das Element selfTestResults enthält für jede Komponente, die Selbsttests unterstützt ein Element vom Typ SelfTestResult. Die Inhalte dieser Elemente sind plausibel. Insbesondere wurde der provozierte Fehler erkannt und die erwartete Fehlermeldung im Element errorMessage abgelegt.</ExpectedResult>
        <ExpectedResult>Die enthaltene Fehlermeldung ist in der Liste aller Fehlermeldungen enthalten.</ExpectedResult>
        <ExpectedResult>Die Daten in selfTestResults des Typs SelfTestResultSet sind identisch mit dem Rückgabewert des Funktionsaufrufs in Testschritt 1.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Prüfung der Liste aller Fehler- und Warnmeldungen, die im Falle eines fehlgeschlagenen Selbsttest im Element errorMessage abgelegt werden können.</Command>
      <ExpectedResults>
        <ExpectedResult>Alle Fehler- und Warnmeldungen enthalten einen für Menschen lesbaren und verständlichen Text, der den Grund des fehlgeschlagenen Selbsttests beschreibt.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
  </TestSteps>
</TestCase>