<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/css" href="../../schema/TR-03153-1-TS.css"?>
<TestCase id="II_LGO_02_B" xmlns="http://bsi.bund.de/TR03153" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://bsi.bund.de/TR03153 ../../schema/TR-03153-1-TS_version-1-2-0.xsd">
  <Title>Automatische Abmeldung nach Inaktivität: admin</Title>
  <Version>1.2.0</Version>
  <Purpose>Prüfung, ob die TSE authentifizierte Nutzer automatisch abmeldet, wenn über einen definierten Zeitraum keine Funktionen aufrufen werden, für die eine Authentifizierung erforderlich ist.
Zusätzlich erfolgt eine Prüfung der erstellten Log-Nachricht.
Es wird der Nutzer admin getestet.</Purpose>
  <RefFunction>logOut</RefFunction>
  <RefUser>admin</RefUser>
  <Profiles>
    <Profile>II</Profile>
  </Profiles>
  <References>
    <Reference>BSI TR-03153-1</Reference>
    <Reference>BSI TR-03151-1</Reference>
  </References>
  <Preconditions>
    <Precondition>Die Technische Sicherheitseinrichtung wurde initialisiert.</Precondition>
    <Precondition>Die Zeit innerhalb des Sicherheitsmoduls wurde aktualisiert.</Precondition>
    <Precondition>Es ist keiner der Nutzer admin, logger oder timeadmin von der Technischen Sicherheitseinrichtung authentifiziert.</Precondition>
  </Preconditions>
  <TestSteps>
    <TestStep>
      <Command>Aufruf der Funktionalität zur Authentifizierung des Nutzers admin.</Command>
      <RefFunction>authenticateUser</RefFunction>
      <RefUser>admin</RefUser>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität zum Auslesen der Beschreibung der TSE.</Command>
      <RefFunction>getDescription</RefFunction>
      <RefUser>admin</RefUser>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Der Nutzer admin ruft für eine Zeit keine Funktion auf, die nur von authentifizierten Nutzern aufgerufen werden dürfen. Diese Zeit entspricht dem Zeitraum nachdem eine automatische Abmeldung eines Nutzers durch die TSE erfolgen soll.</Command>
      <ExpectedResults>
        <ExpectedResult>Der Nutzer admin wird automatisch durch die TSE abgemeldet.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität zum Auslesen der Beschreibung der TSE.</Command>
      <RefFunction>getDescription</RefFunction>
      <RefUser>admin</RefUser>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird beendet und es wird die Fehlermeldung ErrorUserNotAuthenticated  ausgelöst.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Aufruf der Funktionalität für den Export aller Log-Nachrichten sowie von Zertifikaten und Zusatzdateien.</Command>
      <RefFunction>exportLogMessages</RefFunction>
      <RefUser>admin</RefUser>
      <ExpectedResults>
        <ExpectedResult>Die Ausführung wird ohne Fehlermeldung beendet.</ExpectedResult>
        <ExpectedResult>Die TSE-Schnittstelle gibt einen TAR-Container zurück.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Identifikation der Log-Nachricht für die Abmeldung des Nutzers admin in dem TAR-Container. Die Identifikation erfolgt anhand des Dateinamens.</Command>
      <ExpectedResults>
        <ExpectedResult>Der TAR-Container enthält eine Log-Nachricht für die Abmeldung des Nutzers admin.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
    <TestStep>
      <Command>Prüfung der Inhalte von Datenfeldern in der Log-Nachricht für die Abmeldung des Nutzers admin in dem TAR-Container.</Command>
      <ExpectedResults>
        <ExpectedResult>Der Wert des Datenfelds eventType entspricht logOut.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds loggedOutUserId entspricht admin.</ExpectedResult>
        <ExpectedResult>Der Wert des Datenfelds logOutCause entspricht timeout.</ExpectedResult>
      </ExpectedResults>
    </TestStep>
  </TestSteps>
</TestCase>